# ğŸ¯ Sales Module - Quick Reference Card
## Top Priority Features for Taqdeer Domestic Workers

---

## ğŸ“‹ SALES LIST - Add These 3 Critical Columns

### 1. **VISA STATUS** (MOST IMPORTANT!)
```
Column: Visa Status
Display:
  ğŸ”´ EXPIRED - Overstay: 5 days â†’ Red badge, urgent action
  ğŸŸ¡ EXPIRING - 5 days left â†’ Yellow badge, warning
  ğŸŸ¢ VALID - 45 days left â†’ Green badge, all good

Why: Client specifically asked for visa tracking and overstay monitoring
```

### 2. **CURRENT LOCATION**
```
Column: Location/Status
Display:
  ğŸ“ At Office (Available)
  ğŸ  With Sponsor - Trial (Day 45/180)
  âœ… With Sponsor - Confirmed
  â†©ï¸ Returned to Office

Why: Client needs to know worker availability at all times
```

### 3. **TRIAL PROGRESS**
```
Column: Trial Status
Display:
  â³ Not Started - Quotation
  ğŸ”µ On Trial - Day 45/180 (25%)
  âœ… Completed - Success
  âŒ Returned - Failed

Why: Track 6-month trial period performance
```

---

## ğŸ“„ SALES DETAILS - Add These 4 Critical Tabs

### 1. **VISA & ARRIVAL TAB** â­â­â­
```
Show:
  âœˆï¸ ARRIVAL INFO
    â€¢ Arrival Date: Dec 28, 2024
    â€¢ Airport: Dubai International (DXB)
    â€¢ Flight: EK 604
    â€¢ Picked up by: Mohammed (Staff)
    â€¢ Days at Office: 8 days

  ğŸ›‚ VISA INFO
    â€¢ Type: Visit Visa (30 days)
    â€¢ Number: VIS-2024-123456
    â€¢ Issue Date: Dec 15, 2024
    â€¢ Expiry Date: Jan 27, 2025
    â€¢ Status: ğŸ”´ EXPIRED - Overstay 5 days!
    â€¢ Alert: Action required immediately!

  ğŸ“ CURRENT LOCATION
    â€¢ Status: With Sponsor (On Trial)
    â€¢ Address: Villa 123, Palm Jumeirah
    â€¢ Moved Date: Jan 10, 2025

Why: Complete tracking from airport arrival to current location
```

### 2. **TRIAL TRACKING TAB (ENHANCED)** â­â­â­
```
Show:
  ğŸ“… TIMELINE
    Dec 28: Worker arrived at airport
    Dec 29: Registered in system
    Jan 8: Interview with sponsor â†’ SELECTED
    Jan 9: Advance payment received (AED 2,500)
    Jan 10: Sent to sponsor home (TRIAL START)

  ğŸ”µ TRIAL PERIOD (6 MONTHS = 180 DAYS)
    Start: Jan 10, 2025
    End: Jul 10, 2025
    Progress: Day 5/180 (3%) â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘

  âœ… CHECK-IN MILESTONES
    Week 1 (Jan 17):  â³ Due in 2 days - [Schedule Call]
    Week 2 (Jan 24):  â³ Pending
    Month 1 (Feb 10): â³ Pending
    Month 2 (Mar 10): â³ Pending
    Month 3 (Apr 10): â³ Pending
    Month 6 (Jul 10): â³ Final Check

  ğŸ“ FEEDBACK
    [No feedback yet - First check-in scheduled]

Why: Monitor trial period with scheduled check-ins
```

### 3. **REFUND CALCULATOR (INTERACTIVE)** â­â­â­
```
Show in Contract Tab:

  âš–ï¸ REFUND CALCULATOR
    Total Paid: AED 5,000
    Contract: 24 months
    Monthly Rate: AED 208.33 (5000 Ã· 24)

    SCENARIO 1: Normal Return
    Enter months worked: [10] months
    â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
    â€¢ Worked period value: AED 2,083 (208.33 Ã— 10)
    â€¢ REFUND AMOUNT: AED 2,917 (5000 - 2,083)

    SCENARIO 2: Special Cases (FULL REFUND)
    â˜‘ï¸ Worker became ill
    â˜‘ï¸ Worker became pregnant
    â˜‘ï¸ Worker absconded
    â†’ FULL REFUND: AED 5,000

    [Calculate Refund] [Process Return] [Generate Credit Note]

Why: Client specifically explained proportional refund calculation
```

### 4. **ACTIVITY TIMELINE TAB** â­â­
```
Show complete chronological history:

  ğŸ“… ACTIVITY LOG
    â— Dec 28, 2024, 3:45 PM
      âœˆï¸ Worker arrived at Dubai Airport
      Flight: EK 604, Picked by: Mohammed

    â— Dec 29, 2024, 10:30 AM
      ğŸ“ Worker registered in system
      By: Receptionist Sarah

    â— Jan 8, 2025, 3:30 PM
      âœ… Interview completed - SELECTED
      By: Sales Agent Ali

    â— Jan 9, 2025, 10:00 AM
      ğŸ’µ Advance payment received - AED 2,500
      By: Accounts Fatima

    â— Jan 10, 2025, 9:00 AM
      ğŸ  Worker sent to sponsor (TRIAL START)
      By: Operations Layla

Why: Complete transparency and audit trail
```

---

## ğŸ¨ COLOR CODING SYSTEM

```
ğŸ”´ RED (Critical/Urgent)
   â€¢ Visa expired/overstay
   â€¢ Serious issue during trial
   â€¢ Payment overdue
   â€¢ Action required immediately

ğŸŸ¡ YELLOW (Warning/Soon)
   â€¢ Visa expiring in < 7 days
   â€¢ Check-in due
   â€¢ Payment pending
   â€¢ Attention needed

ğŸŸ¢ GREEN (Good/Success)
   â€¢ Visa valid
   â€¢ Payment complete
   â€¢ Trial successful
   â€¢ All good

ğŸ”µ BLUE (In Progress)
   â€¢ On trial
   â€¢ Processing
   â€¢ Ongoing

âšª GRAY (Neutral/Pending)
   â€¢ Not started
   â€¢ Pending
   â€¢ Cancelled
```

---

## ğŸš¨ ALERT WIDGETS FOR DASHBOARD

### 1. VISA ALERTS
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ›‚ VISA STATUS      â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ ğŸ”´ Expired: 3      â”‚
â”‚ ğŸŸ¡ Expiring: 7     â”‚
â”‚ ğŸŸ¢ Valid: 45       â”‚
â”‚                    â”‚
â”‚ [View All]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2. WORKER AVAILABILITY
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ‘¥ WORKERS          â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ Available: 8       â”‚
â”‚ On Trial: 12       â”‚
â”‚ Working: 45        â”‚
â”‚ Returned: 5        â”‚
â”‚                    â”‚
â”‚ [View All]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 3. TRIAL STATUS
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ”µ TRIAL PERIOD     â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ On Trial: 12       â”‚
â”‚ Success: 45        â”‚
â”‚ Returned: 5        â”‚
â”‚ Success Rate: 90%  â”‚
â”‚                    â”‚
â”‚ [View All]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 4. PENDING ACTIONS
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ âš ï¸ URGENT ACTIONS   â”‚
â”‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”‚
â”‚ ğŸ”´ 3 Visa overstaysâ”‚
â”‚ ğŸŸ¡ 7 Check-ins due â”‚
â”‚ ğŸ’° 5 Payments due  â”‚
â”‚                    â”‚
â”‚ [View All]         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ¯ MODEL UPDATES NEEDED

### Add to `sales.model.ts`:
```typescript
export interface Sale {
  // ... existing fields ...

  // â­ VISA & ARRIVAL (NEW)
  visaInfo: {
    visaType: 'visit' | 'work';
    visaNumber: string;
    issueDate: string;
    expiryDate: string;
    visaSponsor: string;
  }
  arrivalInfo: {
    arrivalDate: string;
    airport: string;
    flightNumber?: string;
    pickedUpBy?: string;
  }

  // â­ LOCATION (NEW)
  currentStatus: 'at-office' | 'with-sponsor-trial' | 'with-sponsor-confirmed' | 'returned';
  currentLocation: {
    address?: string;
    movedDate: string;
  }

  // â­ INTERVIEW (NEW)
  interviewInfo: {
    daysAtOfficeBeforeInterview: number;
    interviewDateTime: string;
    interviewFeedback?: string;
  }

  // â­ TRIAL CHECK-INS (NEW)
  trialCheckIns: {
    week1?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    week2?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month1?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month2?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month3?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month6?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
  }

  // â­ ACTIVITY LOG (NEW)
  activityLog: Array<{
    timestamp: string;
    action: string;
    description: string;
    performedBy: string;
  }>
}
```

---

## ğŸ“Š UTILITY FUNCTIONS NEEDED

### In `sales.service.ts`:
```typescript
// Calculate visa status
getVisaStatus(expiryDate: string): 'expired' | 'expiring-soon' | 'valid' {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const daysRemaining = Math.floor((expiry.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
  
  if (daysRemaining < 0) return 'expired';
  if (daysRemaining <= 7) return 'expiring-soon';
  return 'valid';
}

// Calculate overstay days
getOverstayDays(expiryDate: string): number {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const days = Math.floor((today.getTime() - expiry.getTime()) / (1000 * 60 * 60 * 24));
  return days > 0 ? days : 0;
}

// Calculate days remaining
getDaysRemaining(expiryDate: string): number {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const days = Math.floor((expiry.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
  return days > 0 ? days : 0;
}

// Calculate trial progress
getTrialProgress(startDate: string, endDate: string): number {
  const start = new Date(startDate).getTime();
  const end = new Date(endDate).getTime();
  const now = Date.now();
  const total = end - start;
  const elapsed = now - start;
  return Math.min(100, Math.max(0, (elapsed / total) * 100));
}

// Calculate refund amount
calculateRefund(totalAmount: number, contractDuration: number, monthsWorked: number): {
  monthlyRate: number;
  workedValue: number;
  refundAmount: number;
} {
  const monthlyRate = totalAmount / contractDuration;
  const workedValue = monthlyRate * monthsWorked;
  const refundAmount = totalAmount - workedValue;
  
  return {
    monthlyRate: Math.round(monthlyRate * 100) / 100,
    workedValue: Math.round(workedValue * 100) / 100,
    refundAmount: Math.round(refundAmount * 100) / 100
  };
}

// Add activity log entry
addActivityLog(sale: Sale, action: string, description: string, performedBy: string): void {
  if (!sale.activityLog) {
    sale.activityLog = [];
  }
  sale.activityLog.unshift({
    timestamp: new Date().toISOString(),
    action: action,
    description: description,
    performedBy: performedBy
  });
}
```

---

## ğŸ¯ FILTERS TO ADD IN SALES LIST

```html
<!-- Enhanced Filters Section -->
<div class="filters grid grid-cols-4 gap-4">
  <!-- Worker Type Filter -->
  <select [(ngModel)]="workerTypeFilter">
    <option value="all">All Types</option>
    <option value="housemaid">Housemaid</option>
    <option value="cleaner">Cleaner</option>
    <option value="cook">Cook</option>
    <option value="babysitter">Babysitter</option>
    <option value="driver">Driver</option>
    <option value="gardener">Gardener</option>
  </select>

  <!-- Nationality Filter -->
  <select [(ngModel)]="nationalityFilter">
    <option value="all">All Nationalities</option>
    <option value="Ethiopia">Ethiopia (AED 5K)</option>
    <option value="India">India (AED 12K)</option>
    <option value="Sri Lanka">Sri Lanka (AED 15K)</option>
    <option value="Nepal">Nepal (AED 14K)</option>
    <option value="Philippines">Philippines (AED 12K)</option>
  </select>

  <!-- Visa Status Filter -->
  <select [(ngModel)]="visaStatusFilter">
    <option value="all">All Visa Status</option>
    <option value="expired">ğŸ”´ Expired</option>
    <option value="expiring">ğŸŸ¡ Expiring Soon</option>
    <option value="valid">ğŸŸ¢ Valid</option>
  </select>

  <!-- Location Filter -->
  <select [(ngModel)]="locationFilter">
    <option value="all">All Locations</option>
    <option value="at-office">At Office</option>
    <option value="with-sponsor">With Sponsor</option>
    <option value="returned">Returned</option>
  </select>
</div>
```

---

## âœ… DEMO CHECKLIST

When presenting to Taqdeer:

### Show These 5 Things:
1. âœ… **Visa Tracking** - "See how we track visa expiry automatically, no manual checking needed"
2. âœ… **Worker Location** - "Always know where each worker is at any time"
3. âœ… **Trial Monitoring** - "6-month trial with scheduled check-ins, no worker gets lost"
4. âœ… **Refund Calculator** - "Automatic calculation based on months worked, as you requested"
5. âœ… **Simple Interface** - "Everything is about domestic workers, nothing irrelevant like RightERP"

### Say These Things:
- âœ… "This is NOT like RightERP - every feature here is specifically for your domestic worker business"
- âœ… "Visa alerts will prevent overstays automatically"
- âœ… "You'll always know which workers are available at the office vs with sponsors"
- âœ… "Refunds are calculated exactly as you described - proportionally based on months worked"
- âœ… "Invoice only generates after full payment, as per your requirement"

### Avoid These:
- âŒ Don't show technical details or code
- âŒ Don't use complex terminology
- âŒ Don't show features they don't need
- âŒ Don't compare too much with RightERP (focus on YOUR solution)

---

## ğŸš€ IMPLEMENTATION ORDER

### Day 1-2: Visa Tracking
- Add visa fields to model
- Update sales list to show visa status
- Add visa alerts
- Create Visa & Arrival tab

### Day 3-4: Location & Trial
- Add location tracking
- Enhance trial tracking tab
- Add check-in milestones
- Add trial progress indicators

### Day 5-6: Refund & Timeline
- Create refund calculator
- Add activity timeline
- Link all activities

### Day 7: Polish & Test
- Test all features
- Fix bugs
- Polish UI
- Prepare demo

---

**This quick reference shows you exactly what to add to make the Sales module perfect for Taqdeer!** ğŸ¯

