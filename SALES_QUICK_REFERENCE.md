# 🎯 Sales Module - Quick Reference Card
## Top Priority Features for Taqdeer Domestic Workers

---

## 📋 SALES LIST - Add These 3 Critical Columns

### 1. **VISA STATUS** (MOST IMPORTANT!)
```
Column: Visa Status
Display:
  🔴 EXPIRED - Overstay: 5 days → Red badge, urgent action
  🟡 EXPIRING - 5 days left → Yellow badge, warning
  🟢 VALID - 45 days left → Green badge, all good

Why: Client specifically asked for visa tracking and overstay monitoring
```

### 2. **CURRENT LOCATION**
```
Column: Location/Status
Display:
  📍 At Office (Available)
  🏠 With Sponsor - Trial (Day 45/180)
  ✅ With Sponsor - Confirmed
  ↩️ Returned to Office

Why: Client needs to know worker availability at all times
```

### 3. **TRIAL PROGRESS**
```
Column: Trial Status
Display:
  ⏳ Not Started - Quotation
  🔵 On Trial - Day 45/180 (25%)
  ✅ Completed - Success
  ❌ Returned - Failed

Why: Track 6-month trial period performance
```

---

## 📄 SALES DETAILS - Add These 4 Critical Tabs

### 1. **VISA & ARRIVAL TAB** ⭐⭐⭐
```
Show:
  ✈️ ARRIVAL INFO
    • Arrival Date: Dec 28, 2024
    • Airport: Dubai International (DXB)
    • Flight: EK 604
    • Picked up by: Mohammed (Staff)
    • Days at Office: 8 days

  🛂 VISA INFO
    • Type: Visit Visa (30 days)
    • Number: VIS-2024-123456
    • Issue Date: Dec 15, 2024
    • Expiry Date: Jan 27, 2025
    • Status: 🔴 EXPIRED - Overstay 5 days!
    • Alert: Action required immediately!

  📍 CURRENT LOCATION
    • Status: With Sponsor (On Trial)
    • Address: Villa 123, Palm Jumeirah
    • Moved Date: Jan 10, 2025

Why: Complete tracking from airport arrival to current location
```

### 2. **TRIAL TRACKING TAB (ENHANCED)** ⭐⭐⭐
```
Show:
  📅 TIMELINE
    Dec 28: Worker arrived at airport
    Dec 29: Registered in system
    Jan 8: Interview with sponsor → SELECTED
    Jan 9: Advance payment received (AED 2,500)
    Jan 10: Sent to sponsor home (TRIAL START)

  🔵 TRIAL PERIOD (6 MONTHS = 180 DAYS)
    Start: Jan 10, 2025
    End: Jul 10, 2025
    Progress: Day 5/180 (3%) ████░░░░░░░░░░░░

  ✅ CHECK-IN MILESTONES
    Week 1 (Jan 17):  ⏳ Due in 2 days - [Schedule Call]
    Week 2 (Jan 24):  ⏳ Pending
    Month 1 (Feb 10): ⏳ Pending
    Month 2 (Mar 10): ⏳ Pending
    Month 3 (Apr 10): ⏳ Pending
    Month 6 (Jul 10): ⏳ Final Check

  📝 FEEDBACK
    [No feedback yet - First check-in scheduled]

Why: Monitor trial period with scheduled check-ins
```

### 3. **REFUND CALCULATOR (INTERACTIVE)** ⭐⭐⭐
```
Show in Contract Tab:

  ⚖️ REFUND CALCULATOR
    Total Paid: AED 5,000
    Contract: 24 months
    Monthly Rate: AED 208.33 (5000 ÷ 24)

    SCENARIO 1: Normal Return
    Enter months worked: [10] months
    ━━━━━━━━━━━━━━━━━━━━━━━━━━━━
    • Worked period value: AED 2,083 (208.33 × 10)
    • REFUND AMOUNT: AED 2,917 (5000 - 2,083)

    SCENARIO 2: Special Cases (FULL REFUND)
    ☑️ Worker became ill
    ☑️ Worker became pregnant
    ☑️ Worker absconded
    → FULL REFUND: AED 5,000

    [Calculate Refund] [Process Return] [Generate Credit Note]

Why: Client specifically explained proportional refund calculation
```

### 4. **ACTIVITY TIMELINE TAB** ⭐⭐
```
Show complete chronological history:

  📅 ACTIVITY LOG
    ● Dec 28, 2024, 3:45 PM
      ✈️ Worker arrived at Dubai Airport
      Flight: EK 604, Picked by: Mohammed

    ● Dec 29, 2024, 10:30 AM
      📝 Worker registered in system
      By: Receptionist Sarah

    ● Jan 8, 2025, 3:30 PM
      ✅ Interview completed - SELECTED
      By: Sales Agent Ali

    ● Jan 9, 2025, 10:00 AM
      💵 Advance payment received - AED 2,500
      By: Accounts Fatima

    ● Jan 10, 2025, 9:00 AM
      🏠 Worker sent to sponsor (TRIAL START)
      By: Operations Layla

Why: Complete transparency and audit trail
```

---

## 🎨 COLOR CODING SYSTEM

```
🔴 RED (Critical/Urgent)
   • Visa expired/overstay
   • Serious issue during trial
   • Payment overdue
   • Action required immediately

🟡 YELLOW (Warning/Soon)
   • Visa expiring in < 7 days
   • Check-in due
   • Payment pending
   • Attention needed

🟢 GREEN (Good/Success)
   • Visa valid
   • Payment complete
   • Trial successful
   • All good

🔵 BLUE (In Progress)
   • On trial
   • Processing
   • Ongoing

⚪ GRAY (Neutral/Pending)
   • Not started
   • Pending
   • Cancelled
```

---

## 🚨 ALERT WIDGETS FOR DASHBOARD

### 1. VISA ALERTS
```
┌─────────────────────┐
│ 🛂 VISA STATUS      │
│ ───────────────────│
│ 🔴 Expired: 3      │
│ 🟡 Expiring: 7     │
│ 🟢 Valid: 45       │
│                    │
│ [View All]         │
└─────────────────────┘
```

### 2. WORKER AVAILABILITY
```
┌─────────────────────┐
│ 👥 WORKERS          │
│ ───────────────────│
│ Available: 8       │
│ On Trial: 12       │
│ Working: 45        │
│ Returned: 5        │
│                    │
│ [View All]         │
└─────────────────────┘
```

### 3. TRIAL STATUS
```
┌─────────────────────┐
│ 🔵 TRIAL PERIOD     │
│ ───────────────────│
│ On Trial: 12       │
│ Success: 45        │
│ Returned: 5        │
│ Success Rate: 90%  │
│                    │
│ [View All]         │
└─────────────────────┘
```

### 4. PENDING ACTIONS
```
┌─────────────────────┐
│ ⚠️ URGENT ACTIONS   │
│ ───────────────────│
│ 🔴 3 Visa overstays│
│ 🟡 7 Check-ins due │
│ 💰 5 Payments due  │
│                    │
│ [View All]         │
└─────────────────────┘
```

---

## 🎯 MODEL UPDATES NEEDED

### Add to `sales.model.ts`:
```typescript
export interface Sale {
  // ... existing fields ...

  // ⭐ VISA & ARRIVAL (NEW)
  visaInfo: {
    visaType: 'visit' | 'work';
    visaNumber: string;
    issueDate: string;
    expiryDate: string;
    visaSponsor: string;
  }
  arrivalInfo: {
    arrivalDate: string;
    airport: string;
    flightNumber?: string;
    pickedUpBy?: string;
  }

  // ⭐ LOCATION (NEW)
  currentStatus: 'at-office' | 'with-sponsor-trial' | 'with-sponsor-confirmed' | 'returned';
  currentLocation: {
    address?: string;
    movedDate: string;
  }

  // ⭐ INTERVIEW (NEW)
  interviewInfo: {
    daysAtOfficeBeforeInterview: number;
    interviewDateTime: string;
    interviewFeedback?: string;
  }

  // ⭐ TRIAL CHECK-INS (NEW)
  trialCheckIns: {
    week1?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    week2?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month1?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month2?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month3?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
    month6?: { date?: string; feedback?: string; status: 'pending' | 'completed' };
  }

  // ⭐ ACTIVITY LOG (NEW)
  activityLog: Array<{
    timestamp: string;
    action: string;
    description: string;
    performedBy: string;
  }>
}
```

---

## 📊 UTILITY FUNCTIONS NEEDED

### In `sales.service.ts`:
```typescript
// Calculate visa status
getVisaStatus(expiryDate: string): 'expired' | 'expiring-soon' | 'valid' {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const daysRemaining = Math.floor((expiry.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
  
  if (daysRemaining < 0) return 'expired';
  if (daysRemaining <= 7) return 'expiring-soon';
  return 'valid';
}

// Calculate overstay days
getOverstayDays(expiryDate: string): number {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const days = Math.floor((today.getTime() - expiry.getTime()) / (1000 * 60 * 60 * 24));
  return days > 0 ? days : 0;
}

// Calculate days remaining
getDaysRemaining(expiryDate: string): number {
  const today = new Date();
  const expiry = new Date(expiryDate);
  const days = Math.floor((expiry.getTime() - today.getTime()) / (1000 * 60 * 60 * 24));
  return days > 0 ? days : 0;
}

// Calculate trial progress
getTrialProgress(startDate: string, endDate: string): number {
  const start = new Date(startDate).getTime();
  const end = new Date(endDate).getTime();
  const now = Date.now();
  const total = end - start;
  const elapsed = now - start;
  return Math.min(100, Math.max(0, (elapsed / total) * 100));
}

// Calculate refund amount
calculateRefund(totalAmount: number, contractDuration: number, monthsWorked: number): {
  monthlyRate: number;
  workedValue: number;
  refundAmount: number;
} {
  const monthlyRate = totalAmount / contractDuration;
  const workedValue = monthlyRate * monthsWorked;
  const refundAmount = totalAmount - workedValue;
  
  return {
    monthlyRate: Math.round(monthlyRate * 100) / 100,
    workedValue: Math.round(workedValue * 100) / 100,
    refundAmount: Math.round(refundAmount * 100) / 100
  };
}

// Add activity log entry
addActivityLog(sale: Sale, action: string, description: string, performedBy: string): void {
  if (!sale.activityLog) {
    sale.activityLog = [];
  }
  sale.activityLog.unshift({
    timestamp: new Date().toISOString(),
    action: action,
    description: description,
    performedBy: performedBy
  });
}
```

---

## 🎯 FILTERS TO ADD IN SALES LIST

```html
<!-- Enhanced Filters Section -->
<div class="filters grid grid-cols-4 gap-4">
  <!-- Worker Type Filter -->
  <select [(ngModel)]="workerTypeFilter">
    <option value="all">All Types</option>
    <option value="housemaid">Housemaid</option>
    <option value="cleaner">Cleaner</option>
    <option value="cook">Cook</option>
    <option value="babysitter">Babysitter</option>
    <option value="driver">Driver</option>
    <option value="gardener">Gardener</option>
  </select>

  <!-- Nationality Filter -->
  <select [(ngModel)]="nationalityFilter">
    <option value="all">All Nationalities</option>
    <option value="Ethiopia">Ethiopia (AED 5K)</option>
    <option value="India">India (AED 12K)</option>
    <option value="Sri Lanka">Sri Lanka (AED 15K)</option>
    <option value="Nepal">Nepal (AED 14K)</option>
    <option value="Philippines">Philippines (AED 12K)</option>
  </select>

  <!-- Visa Status Filter -->
  <select [(ngModel)]="visaStatusFilter">
    <option value="all">All Visa Status</option>
    <option value="expired">🔴 Expired</option>
    <option value="expiring">🟡 Expiring Soon</option>
    <option value="valid">🟢 Valid</option>
  </select>

  <!-- Location Filter -->
  <select [(ngModel)]="locationFilter">
    <option value="all">All Locations</option>
    <option value="at-office">At Office</option>
    <option value="with-sponsor">With Sponsor</option>
    <option value="returned">Returned</option>
  </select>
</div>
```

---

## ✅ DEMO CHECKLIST

When presenting to Taqdeer:

### Show These 5 Things:
1. ✅ **Visa Tracking** - "See how we track visa expiry automatically, no manual checking needed"
2. ✅ **Worker Location** - "Always know where each worker is at any time"
3. ✅ **Trial Monitoring** - "6-month trial with scheduled check-ins, no worker gets lost"
4. ✅ **Refund Calculator** - "Automatic calculation based on months worked, as you requested"
5. ✅ **Simple Interface** - "Everything is about domestic workers, nothing irrelevant like RightERP"

### Say These Things:
- ✅ "This is NOT like RightERP - every feature here is specifically for your domestic worker business"
- ✅ "Visa alerts will prevent overstays automatically"
- ✅ "You'll always know which workers are available at the office vs with sponsors"
- ✅ "Refunds are calculated exactly as you described - proportionally based on months worked"
- ✅ "Invoice only generates after full payment, as per your requirement"

### Avoid These:
- ❌ Don't show technical details or code
- ❌ Don't use complex terminology
- ❌ Don't show features they don't need
- ❌ Don't compare too much with RightERP (focus on YOUR solution)

---

## 🚀 IMPLEMENTATION ORDER

### Day 1-2: Visa Tracking
- Add visa fields to model
- Update sales list to show visa status
- Add visa alerts
- Create Visa & Arrival tab

### Day 3-4: Location & Trial
- Add location tracking
- Enhance trial tracking tab
- Add check-in milestones
- Add trial progress indicators

### Day 5-6: Refund & Timeline
- Create refund calculator
- Add activity timeline
- Link all activities

### Day 7: Polish & Test
- Test all features
- Fix bugs
- Polish UI
- Prepare demo

---

**This quick reference shows you exactly what to add to make the Sales module perfect for Taqdeer!** 🎯

